package com.gdufs.dao;import java.sql.Connection;import java.sql.Date;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;public class CreateGameDao { //检查比赛名是否存在 public boolean checkName(String gameName) {  Connection con = DBHelper.connect();  PreparedStatement stat = null;  String sql = "select * from gdufs.game where gameName='"+gameName+"';";    try {   stat = con.prepareStatement(sql);   ResultSet rs = stat.executeQuery();   if(rs.next()) {    return true;   }   else {    return false;   }  } catch (SQLException e) {   e.getStackTrace();   return false;  } finally {     } }  //新建比赛存入比赛表中 public boolean addGame(String gameName,Date startTime,Date endTime,String type,String status,int number) {  Connection con = DBHelper.connect();  PreparedStatement stat = null;  String sql = "insert into gdufs.game values('"+gameName+"','"+startTime+"','"+endTime+"','"+type+"','"+status+"','"+number+"');";    try {   stat = con.prepareStatement(sql);   int i = stat.executeUpdate();   if(i<=0) {    return false;   }   else {    return true;   }  } catch (SQLException e) {   e.getStackTrace();   return false;  } finally {     } }  //比赛结束，改变比赛状态 public boolean getStatus(String gameName) {  Connection con = DBHelper.connect();  PreparedStatement stat = null;  String sql = "update gdufs.game set status='结束' where gameName='"+gameName+"';";    try {   stat = con.prepareStatement(sql);   int i = stat.executeUpdate();   if(i<=0) {    return false;   }   else {    return true;   }  } catch (SQLException e) {   e.getStackTrace();   return false;  } finally {     } }  //参加比赛的球队插入到球队-比赛表中 public boolean addTeam(String gameName,String teamName) {  Connection con = DBHelper.connect();  PreparedStatement stat = null;  String sql = "insert into gdufs.teamGame values('"+gameName+"','"+teamName+"','存活','');";    try {   stat = con.prepareStatement(sql);   int i = stat.executeUpdate();   if(i<=0) {    return false;   }   else {    return true;   }  } catch (SQLException e) {   e.getStackTrace();   return false;  } finally {     } }  //球队淘汰或者比赛结束，改变该球队在该比赛中的状态 public boolean updateTeamStatus(String gameName,String teamName,int rank) {  Connection con = DBHelper.connect();  PreparedStatement stat = null;  String sql = "update gdufs.teamGame set status='结束',rank='"+rank+"' where gameName='"+gameName+"' and teamName='"+teamName+"';";    try {   stat = con.prepareStatement(sql);   int i = stat.executeUpdate();   if(i<=0) {    return false;   }   else {    return true;   }  } catch (SQLException e) {   e.getStackTrace();   return false;  } finally {     } }}
